* hs-indent-fold

Click-to-fold functionality via indent region detection for Emacs.

** Overview

=hs-indent-fold= provides a simple click-to-fold interface by placing mouse-clickable regions in the indentation area of your code. Clicking on the indentation toggles the fold state using =hideshow=.

** Motivation

Traditional code folding packages like =hideshowvis= or =origami= typically display fold indicators in the margin or fringe areas. However, these areas are often contested by other useful packages:

- =flymake= / =flycheck= - Display diagnostic indicators
- =diff-hl= / =git-gutter= - Show version control changes

Configuring multiple packages to coexist in these limited spaces can be cumbersome and often leads to visual conflicts.

*hs-indent-fold* takes a different approach: it makes the indentation region clickable. This leaves the margin and fringe areas completely free for other packages to use without any configuration conflicts.

** Breaking Changes (v0.3)

Version 0.3 is a major simplification. The following features have been *removed*:

- Indent region highlighting (color-coded backgrounds)
- Block-specific color palettes (=hs-indent-fold-dark-palette=, =hs-indent-fold-light-palette=)
- Folded state color indication
- =hs-indent-fold-reset-colors= command
- =hs-indent-fold-color-by-block= option
- =hs-indent-fold-ignore-same-line= option

If you were using any of these customization variables, please remove them from your configuration.

*** Why these changes?

- *Focus on click-to-fold*: This package now focuses solely on providing click-to-fold functionality in the indentation area. For indent visualization, dedicated packages like =indent-bars= offer superior features.
- *Better maintainability*: By using =hideshow= commands (=hs-toggle-hiding=) directly, the implementation is simpler and more maintainable.

** Features

- Click on indent region to fold/unfold using =hideshow=
- Hover highlight for visual feedback
- Minimal and lightweight implementation

** Screenshots

- JSON

  [[file:screenshots/sample1-json.gif]]

- Elisp

  [[file:screenshots/sample2-elisp.gif]]

- Python (with indent-tabs-mode)

  [[file:screenshots/sample3-python.gif]]

** Installation

*** Manual

#+begin_src emacs-lisp
(add-to-list 'load-path "/path/to/hs-indent-fold")
(require 'hs-indent-fold)
#+end_src

*** use-package

#+begin_src emacs-lisp
  (use-package hs-indent-fold
    :vc ( :url "https://github.com/kn66/hs-indent-fold.el.git"
          :rev :newest)
    :hook (prog-mode . hs-indent-fold-mode))
#+end_src

** Usage

Enable the mode in any programming buffer:

#+begin_src emacs-lisp
(add-hook 'prog-mode-hook 'hs-indent-fold-mode)
#+end_src

Or enable it manually with =M-x hs-indent-fold-mode=.

Once enabled, click on the indentation area to toggle folding.

** Customization

#+begin_src emacs-lisp
;; Delay before updating overlays after changes (default: 0.1)
(setq hs-indent-fold-update-delay 0.1)
#+end_src

** Limitations

*** Fold Detection Based on hideshow

This package relies on =hideshow= for fold detection. It calls =hs-toggle-hiding= at the clicked position, so folding behavior depends entirely on how =hideshow= interprets your code.

This means:
- Only lines that =hideshow= recognizes as foldable will actually fold
- Language support depends on =hideshow='s built-in rules or custom configurations

*** Parser Accuracy

=hideshow= uses regular expressions and basic parsing to detect code blocks, which is less accurate than modern parsing techniques like Tree-sitter. As a result:

- Some blocks may not be detected correctly
- Complex or unusual code structures might be misidentified

For more precise code folding, consider Tree-sitter based solutions if available for your Emacs version and programming language.

** Requirements

- Emacs 27.1 or later
- =hideshow= (built-in)

** License

MIT License.

** Contributing

Bug reports and pull requests are welcome.
