* hs-indent-fold

Click-to-fold functionality via indent region highlighting for Emacs.

** Overview

=hs-indent-fold= provides a visual folding interface by highlighting the indentation area of foldable code blocks. Unlike traditional folding packages that use margin or fringe indicators, this package places mouse-clickable regions directly in the indentation space of your code.

** Motivation

Traditional code folding packages like =hideshowvis= or =origami= typically display fold indicators in the margin or fringe areas. However, these areas are often contested by other useful packages:

- =flymake= / =flycheck= - Display diagnostic indicators
- =diff-hl= / =git-gutter= - Show version control changes

Configuring multiple packages to coexist in these limited spaces can be cumbersome and often leads to visual conflicts.

*hs-indent-fold* takes a different approach: it highlights the indentation region of each foldable block, making it clickable. This leaves the margin and fringe areas completely free for other packages to use without any configuration conflicts.

Additionally, traditional folding packages display indicators only at the beginning of each foldable block, requiring you to scroll or navigate to that starting line to toggle the fold. With =hs-indent-fold=, you can click anywhere on the highlighted indentation area within the block to fold or unfold itâ€”no need to navigate back to the block's starting position.

** Features

- Highlights indentation area of foldable blocks detected by =hideshow=
- Click on highlighted indent region to fold/unfold
- Different colors for expanded vs folded states
- Color-coded blocks for visual distinction
- Supports both dark and light themes
- Automatic color adjustment on theme changes
- Hover effects for better interactivity

** Screenshots

- JSON

  [[file:screenshots/sample1-json.gif]]

- Elisp

  [[file:screenshots/sample2-elisp.gif]]

- Python

  [[file:screenshots/sample3-python.gif]]

** Installation

*** Manual

#+begin_src emacs-lisp
(add-to-list 'load-path "/path/to/hs-indent-fold")
(require 'hs-indent-fold)
#+end_src

*** use-package

#+begin_src emacs-lisp
  (use-package hs-indent-fold
    :vc ( :url "https://github.com/kn66/hs-indent-fold.el.git"
          :rev :newest)
    :hook (prog-mode . hs-indent-fold-mode))
#+end_src

** Usage

Enable the mode in any programming buffer:

#+begin_src emacs-lisp
(add-hook 'prog-mode-hook 'hs-indent-fold-mode)
#+end_src

Or enable it manually with =M-x hs-indent-fold-mode=.

Once enabled, click on the highlighted indentation area to toggle folding.

** Customization

*** Colors

#+begin_src emacs-lisp
;; Use different colors for each block (default: t)
(setq hs-indent-fold-color-by-block t)

;; Custom color palettes
(setq hs-indent-fold-dark-palette
      '("#2d3a4f" "#3a2d4f" "#2d4f3a" "#4f3a2d"))

(setq hs-indent-fold-light-palette
      '("#e8f0ff" "#ffe8f0" "#e8fff0" "#fff0e8"))

;; Folded block colors
(setq hs-indent-fold-dark-folded-color "#5f3a3a")
(setq hs-indent-fold-light-folded-color "#ffdfdf")
#+end_src

*** Behavior

#+begin_src emacs-lisp
;; Ignore blocks that end on the same line (default: t)
(setq hs-indent-fold-ignore-same-line t)

;; Delay before updating overlays after changes (default: 0.1)
(setq hs-indent-fold-update-delay 0.1)
#+end_src

*** Reset Colors After Theme Change

Colors are automatically reset when themes change (Emacs 29+). For manual reset:

#+begin_src emacs-lisp
M-x hs-indent-fold-reset-colors
#+end_src

** Limitations

*** Block Detection Based on hideshow

This package relies on =hideshow= for detecting foldable blocks. Unlike packages such as =indent-bars= that highlight indentation uniformly based on whitespace, =hs-indent-fold= highlights only the blocks that =hideshow= recognizes as foldable (functions, classes, etc.).

This means:
- Not all indented regions will be highlighted
- Only syntactically meaningful blocks are marked
- The highlighting follows code structure, not just indentation levels

*** Parser Accuracy

=hideshow= uses regular expressions and basic parsing to detect code blocks, which is less accurate than modern parsing techniques like Tree-sitter. As a result:

- Some blocks may not be detected correctly
- Complex or unusual code structures might be misidentified
- Language support depends on =hideshow='s built-in rules or custom configurations

For more precise code folding, consider Tree-sitter based solutions if available for your Emacs version and programming language.

** Requirements

- Emacs 27.1 or later
- =hideshow= (built-in)

** License

This package is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License.

** Contributing

Bug reports and pull requests are welcome.
